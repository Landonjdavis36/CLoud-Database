<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firestore</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
</head>
<body>
    <div class="container mt-3"> 
        <table class="table table-dark">
            <thead>
                <th>Name</th>
                <th>Street</th>
                <th>City</th>
                <th>State</th>
                <th>Zip</th>
            </thead>
            <tbody id ="tbody1"></tbody>
        </table>
    </div> 

    <script type ="module">
        var zipcode = 0;
        var tbody = document.getElementById('tbody1');
        
        function AddItemToTable(name, Street, City, State){
            let trow = document.createElement("trow");
            let td1 = document.createElement('td');
            let td2 = document.createElement('td');
            let td3 = document.createElement('td');
            let td4 = document.createElement('td');
            let td5 = document.createElement('td');

            td1.innerHTML= ++zipcode;
            td2.innerHTML= name;
            td3.innerHTML= street;
            td4.innerHTML= city;
            td5.innerHTML= state;

            trow.appendChild(td1);
            trow.appendChild(td2);
            trow.appendChild(td3);
            trow.appendChild(td4);
            trow.appendChild(td5);

            tbody.appendChild(trow);
        
         }
         

         function AddAllItemsToTable(Locations){
             zipcode = 0;
             tbody.innerHTML="";
             Locations.forEach(element =>{
                 AddItemToTable(element.name, element.street, element.city, element.state, element.zipcode)
                 
             });

            }

            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.4/firebase-app.js";
            // TODO: Add SDKs for Firebase products that you want to use
            // https://firebase.google.com/docs/web/setup#available-libraries

            // Your web app's Firebase configuration
            const firebaseConfig = {
                apiKey: "AIzaSyBHZFZQA06Slt-59PvkqPWJReSblnwRRYQ",
                authDomain: "cloud-project-f6c91.firebaseapp.com",
                projectId: "cloud-project-f6c91",
                storageBucket: "cloud-project-f6c91.appspot.com",
                messagingSenderId: "727286148",
                appId: "1:727286148:web:f6781bd9b49d5af9011dd1"
            };

            // Initialize Firebase
            const app = initializeApp(firebaseConfig);

            import {
                getFirestore, doc, getDoc, getDocs, onSnapshot, collection
            }
            from "https://www.gstatic.com/firebasejs/9.6.4/firebase-firestore.js";

            const db =getFirestore();

            async function GetAllDataOnce(){
                const querySnapshot = await getDocs(collection(db,"Locations"));
                var names =[];
                querySnapshot.forEach(doc =>{
                    names.push(doc.data());
                });
                AddAllItemsToTable(names);
            }

            async function GetAllDataRealtime(){
                const dbRef = collection(db,"Locations");
                onSnapshot(dbREf,(quarySnapshot) =>{
                    var names =[];
                    quarySnapshot.forEach(doc =>{
                        student.push(doc.data());
                    });
                    AddAllItemsToTable(names);
                })
                
            }



            window.onload = GetAllDataRealtime;
    
    </script>


</body>
</html>